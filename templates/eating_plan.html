{% extends 'base.html' %} {% block head_content %}
<meta http-equiv="refresh" content="1800" />
{% endblock %} {% block title_content %}
<h1>Eating plan</h1>
{% endblock %} 

{% macro render_planning(available_foods_grouped) %}

{% set days = ["M", "T", "W", "T", "F", "S"] %}

<script>
  function updateFoodOptions(week, day) {
      const selectedFoodType = document.getElementById(week + '-' + day + '-foodtype-plan').value;
      const foodSelect = document.getElementById(week + '-' + day + '-food-plan');
      foodSelect.innerHTML = '';

      console.log("JS hello")
  
      // const foods = {{ available_foods_grouped | tojson }};
      // if (foods[selectedFoodType]) {
      //     foods[selectedFoodType].forEach(function(food) {
      //         var option = new Option(food, food);
      //         foodSelect.options.add(option);
      //     });
      // }
  };
  </script>

<div class="mb-3 row">
  <div class="col-md-1">
    <h4>Plan</h4>
  </div>
  <div class="col-md-11">
    <div class="row">
      {% for day in days %}
      <div class="col-md-2">
        <select id="{{ week }}-{{ day }}-foodtype-plan" class="form-select" onchange="updateFoodOptions('{{ week }}', '{{ day }}')">
          {% for food_type in available_foods_grouped %}
          <option value="{{ food_type }}">{{ food_type }}</option>
          {% endfor %}
        </select>
        <select id="{{ week }}-{{ day }}-food-plan" class="form-select">
          {% for food in available_foods_grouped %}
          <option value="{{ food }}">{{ food }}</option>
          {% endfor %}
        </select>
      </div>
      {% endfor %}
    </div>
  </div>
</div>


{% endmacro %}

{% macro render_week(week, meals, available_foods, food_types, available_foods_grouped) %}


<div class="mb-3 row">
  <div class="col-md-1">
    <h4>{{week}}</h4>
  </div>
  <div class="col-md-11">
    <div class="row">
      {% for day, meal in meals.items() %}
      <div class="col-md-2">
        <p>{{meal}}</p>
        <!-- <select id="{{ week }}-{{ day }}-foodtype" class="form-select">
          {% for food_type in food_types %}
          <option value="{{ food_type }}">{{ food_type }}</option>
          {% endfor %}
        </select> -->
        <!-- <label for="{{ week }}-{{ day }}" class="form-label">{{ day }}</label> -->
        <!-- <select id="{{ week }}-{{ day }}-food" class="form-select">
          {% for food in available_foods %}
          <option value="{{ food }}">{{ food }}</option>
          {% endfor %}
        </select> -->
      </div>
      {% endfor %}
    </div>
  </div>
</div>

{% endmacro %} {% block main_content %}

<div class="container mt-4">
  {{ render_planning(available_foods_grouped) }}
  <div class="row">
    <div class="col-md-12"
      <div class="row">
        {% for week, meals in weeks.items() %} {{ render_week(week, meals,
        available_foods, food_types, available_foods_grouped) }} {% endfor %}
      </div>
    </div>
    <!-- <div class="col-md-4">
      <h3>Available Foods</h3>
      <ul class="list-group">
        {% for food in available_foods %}
        <li class="list-group-item">{{ food }}</li>
        {% endfor %}
      </ul>
    </div> -->
  </div>
</div>

<!-- <div>
  {% for category, foods in available_foods_grouped.items() %}
  <p>{{category}}</p>
  {% for food in foods %}
  <p>-> {{food}}</p>
  {% endfor %} {% endfor %}
</div> -->

{% endblock %}
